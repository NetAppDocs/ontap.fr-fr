---
permalink: mediator/index.html 
sidebar: sidebar 
keywords: ontap mediator service, install requirements, mediator requirements 
summary: 'Pour installer le service Mediator ONTAP, vous devez vous assurer que toutes les conditions préalables sont remplies, obtenir le package d"installation et exécuter le programme d"installation sur l"hôte.' 
---
= Installez ou mettez à niveau le service ONTAP Mediator
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Pour installer le service Mediator ONTAP, vous devez vous assurer que toutes les conditions préalables sont remplies, obtenir le package d'installation et exécuter le programme d'installation sur l'hôte. Cette procédure est utilisée pour une installation ou une mise à niveau d'une installation existante.

.Description de la tâche
* À partir de ONTAP 9.7, vous pouvez utiliser n'importe quelle version du Mediator ONTAP pour contrôler une configuration IP MetroCluster.
* À partir de ONTAP 9.8, vous pouvez utiliser n'importe quelle version du médiateur ONTAP pour surveiller une relation SM-BC.


.Avant de commencer
Vous devez remplir les conditions suivantes.

[cols="30,70"]
|===


| Version médiateur | Versions Linux prises en charge 


 a| 
1.5
 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3, 8.4, 8.5
* CentOS: 7.6, 7.7, 7.8, 7.9




 a| 
1.4
 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3, 8.4, 8.5
* CentOS: 7.6, 7.7, 7.8, 7.9




 a| 
1.3
 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3
* CentOS: 7.6, 7.7, 7.8, 7.9




 a| 
1.2
 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 8.1
* CentOS: 7.6, 7.7, 7.8


|===

NOTE: La version du noyau doit correspondre à la version du système d'exploitation.

* installation physique 64 bits ou machine virtuelle
* 8 GO DE RAM
* Utilisateur : accès racine




== Mettez à niveau le système d'exploitation hôte, puis le médiateur

Le tableau suivant fournit les directives de mise à niveau si vous effectuez une mise à niveau de RHEL/CentOS 7.6 vers une version ultérieure de RHEL/CentOS, en plus de mettre à niveau la version Mediator.

[cols="20,20,60"]
|===


| Version Linux cible | Version du médiateur cible | Notes de mise à niveau 


 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 8.1
* CentOS: 7.6, 7.7, 7.8

 a| 
1.2
 a| 
* La mise à jour doit être effectuée dans l'ordre suivant :
+
.. Mettez à niveau le système d'exploitation depuis la version RHEL/CentOS.
.. Redémarrez l'hôte pour appliquer les modifications du module du noyau.
.. Mettez à niveau le Mediator de la version antérieure immédiate à la version actuelle.


* Pour MetroCluster :
+
.. La commande Storage iscsi-initiator show indique que la connexion au service Mediator est interrompue pendant la mise à niveau.
.. Le système d'exploitation ONTAP génère les événements EMS suivants :
+
... cf.mccip.med.auso.stDisabled pendant la mise à niveau
... cf.mccip.med.auso.stEnabled en cas de réactivation du basculement non planifié automatique








 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3
* CentOS: 7.6, 7.7, 7.8, 7.9

 a| 
1.3
 a| 
. Mettez à niveau le système d'exploitation depuis la version RHEL/CentOS.
. Redémarrez l'hôte pour appliquer les modifications du module du noyau.
. Mettez à niveau le Mediator de la version antérieure immédiate à la version actuelle.




 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3, 8.4, 8.5
* CentOS: 7.6, 7.7, 7.8, 7.9

 a| 
1.4
 a| 
. Mettez à niveau le système d'exploitation depuis la version RHEL/CentOS.
. Redémarrez l'hôte pour appliquer les modifications du module du noyau.
. Mettez à niveau le Mediator de la version antérieure immédiate à la version actuelle.




 a| 
* Red Hat Enterprise Linux : 7.6, 7.7, 7.8, 7.9, 8.1 8.2 février 8.3, 8.4, 8.5
* CentOS: 7.6, 7.7, 7.8, 7.9

 a| 
1.5
 a| 
. Mettez à niveau le système d'exploitation depuis la version RHEL/CentOS.
. Redémarrez l'hôte pour appliquer les modifications du module du noyau. Si vous ne redémarrez pas l'hôte, un message d'erreur s'affiche et vous invite à effectuer un redémarrage.
. Mettez à niveau le Mediator de la version antérieure immédiate à la version actuelle.


|===
Les meilleures pratiques d'installation de Red Hat Enterprise Linux ou CentOS ainsi que les référentiels associés sur votre système sont répertoriées ci-dessous. Les systèmes installés ou configurés différemment peuvent nécessiter des étapes supplémentaires.

* Vous devez installer Red Hat Enterprise Linux ou CentOS conformément aux meilleures pratiques de Red Hat. En raison de la fin de vie des versions CentOS 8.x, les versions compatibles de CentOS 8.x ne sont pas recommandées.
* Lors de l'installation du service Mediator ONTAP sur Red Hat Enterprise Linux ou CentOS, le système doit avoir accès au référentiel approprié afin que le programme d'installation puisse accéder à toutes les dépendances logicielles requises et les installer.
* Pour que le programme d'installation de yum trouve des logiciels dépendants dans les référentiels Red Hat Enterprise Linux, vous devez avoir enregistré le système pendant l'installation de Red Hat Enterprise Linux ou ultérieurement en utilisant un abonnement Red Hat valide.
+
Pour plus d'informations sur le Gestionnaire d'abonnement Red Hat, reportez-vous à la documentation Red Hat.

* Les ports suivants doivent être inutilisés et disponibles pour le médiateur :
+
** 31784
** 3260


* Si vous utilisez un pare-feu tiers : reportez-vous à la link:https://docs.netapp.com/us-en/ontap-metrocluster/install-ip/concept_mediator_requirements.html#firewall-requirements-for-ontap-mediator["Exigences relatives au pare-feu pour le médiateur ONTAP"^]
* Si l'hôte Linux se trouve dans un emplacement sans accès à Internet, vous devez vous assurer que les packages requis sont disponibles dans un référentiel local.
+
Si vous utilisez le protocole LACP (Link Aggregation Control Protocol) dans un environnement Linux, vous devez configurer correctement le noyau et vous assurer que le `sysctl net.ipv4.conf.all.arp_ignore` est réglé sur « 2 ».

+
Les packages suivants sont requis par le service ONTAP Mediator :

+
[cols="25,35,40"]
|===


| Toutes les versions de RHEL/CentOS | Paquets supplémentaires pour RHEL/CentOS 7.x | Paquets supplémentaires pour RHEL 8.x 


 a| 
** openssl
** openssl-devel
** noyau-devel
** gcc
** libselinux-utils
** marque
** red hat-lsb-core
** correctif
** bzip2
** python36
** python36-devel
** perl-Data-Dumper
** perl-ExtUtils-MakeMaker
** python3-pip

 a| 
** politiqueutils-python
** python36-pip

 a| 
** elfutils-libelf-devel
** politiqueutils-python-utils


|===


Le package d'installation Mediator est un fichier tar compressé auto-extractible qui comprend :

* Un fichier RPM contenant toutes les dépendances qui ne peuvent pas être obtenues du référentiel de la version prise en charge.
* Un script d'installation.


Une certification SSL valide est recommandée, comme indiqué dans cette procédure.



== Autoriser l'accès aux référentiels

|===


| Si votre système d'exploitation est... | Vous devez donner l'accès à ces référentiels... 


 a| 
RHEL 7.x
 a| 
rhel-7-server-optional-rms



 a| 
CentOS 7.x
 a| 
C7.6.1810 - référentiel de base



 a| 
RHEL 8.x
 a| 
* rhel-8-for-x86_64-baseos-rpms
* rhel-8-for-x86_64-appstream-rpms


|===
Activez l'accès aux référentiels répertoriés ci-dessus afin que Mediator puisse accéder aux modules requis pendant le processus d'installation. Suivez la procédure ci-dessous pour votre système d'exploitation.

* Procédure pour <<rhel7x,RHEL 7.x>> système d'exploitation.
* Procédure pour <<rhel8x,RHEL 8.x>> système d'exploitation.
* Procédure pour <<centos7x,CentOS 7.x>> système d'exploitation.




=== Procédure pour le système d'exploitation RHEL 7.x.

Si votre système d'exploitation est *RHEL 7.x* :

.Étapes
. Abonnez-vous au référentiel requis :
+
`subscription-manager repos --enable rhel-7-server-optional-rpms`

+
L'exemple suivant montre l'exécution de cette commande :

+
[listing]
----
[root@localhost ~]# subscription-manager repos --enable rhel-7-server-optional-rpms
Repository 'rhel-7-server-optional-rpms' is enabled for this system.
----
. Exécutez le `yum repolist` commande.
+
L'exemple suivant montre l'exécution de cette commande. Le référentiel "rhel-7-Server-optional-rpms" devrait apparaître dans la liste.

+
[listing]
----
[root@localhost ~]# yum repolist
Loaded plugins: product-id, search-disabled-repos, subscription-manager
rhel-7-server-optional-rpms | 3.2 kB  00:00:00
rhel-7-server-rpms | 3.5 kB  00:00:00
(1/3): rhel-7-server-optional-rpms/7Server/x86_64/group                                               |  26 kB  00:00:00
(2/3): rhel-7-server-optional-rpms/7Server/x86_64/updateinfo                                          | 2.5 MB  00:00:00
(3/3): rhel-7-server-optional-rpms/7Server/x86_64/primary_db                                          | 8.3 MB  00:00:01
repo id                                      repo name                                             status
rhel-7-server-optional-rpms/7Server/x86_64   Red Hat Enterprise Linux 7 Server - Optional (RPMs)   19,447
rhel-7-server-rpms/7Server/x86_64            Red Hat Enterprise Linux 7 Server (RPMs)              26,758
repolist: 46,205
[root@localhost ~]#
----




=== Procédure pour le système d'exploitation RHEL 8.x.

Si votre système d'exploitation est *RHEL 8.x* :

.Étapes
. Abonnez-vous au référentiel requis :
+
`subscription-manager repos --enable rhel-8-for-x86_64-baseos-rpms`

+
`subscription-manager repos --enable rhel-8-for-x86_64-appstream-rpms`

+
L'exemple suivant montre l'exécution de cette commande :

+
[listing]
----
[root@localhost ~]# subscription-manager repos --enable rhel-8-for-x86_64-baseos-rpms
[root@localhost ~]# subscription-manager repos --enable rhel-8-for-x86_64-appstream-rpms
Repository 'rhel-8-for-x86_64-baseos-rpms' is enabled for this system.
Repository 'rhel-8-for-x86_64-appstream-rpms' is enabled for this system.
----
. Exécutez le `yum repolist` commande.
+
Les nouveaux référentiels auxquels vous êtes abonné doivent apparaître dans la liste.





=== Procédure pour le système d'exploitation CentOS 7.x.

Si votre système d'exploitation est *CentOS 7.x* :


NOTE: Les exemples suivants montrent un référentiel pour CentOS 7.6 et peuvent ne pas fonctionner pour d'autres versions de CentOS. Utilisez le référentiel de base pour votre version de CentOS.

.Étapes
. Ajoutez le référentiel C7.6.1810 - base. Le référentiel de coffre-fort C7.6.1810 - base contient le package kernel-devel nécessaire pour le médiateur ONTAP.
. Ajoutez les lignes suivantes à /etc/yum.repos.d/CentOS-Vault.repo.
+
[listing]
----
[C7.6.1810-base]
name=CentOS-7.6.1810 - Base
baseurl=http://vault.centos.org/7.6.1810/os/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
enabled=1
----
. Exécutez le `yum repolist` commande.
+
L'exemple suivant montre l'exécution de cette commande. Le référentiel CentOS-7.6.1810 - base doit apparaître dans la liste.

+
[listing]
----
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: distro.ibiblio.org
 * extras: distro.ibiblio.org
 * updates: ewr.edge.kernel.org
C7.6.1810-base                                                   | 3.6 kB  00:00:00
(1/2): C7.6.1810-base/x86_64/group_gz                            | 166 kB  00:00:00
(2/2): C7.6.1810-base/x86_64/primary_db                          | 6.0 MB  00:00:04
repo id                                           repo name                                                                                                    status
C7.6.1810-base/x86_64                             CentOS-7.6.1810 - Base                                                                                       10,019
base/7/x86_64                                     CentOS-7 - Base                                                                                              10,097
extras/7/x86_64                                   CentOS-7 - Extras                                                                                               307
updates/7/x86_64                                  CentOS-7 - Updates                                                                                            1,010
repolist: 21,433
[root@localhost ~]#
----




== Téléchargez le package d'installation du Mediator

.Étapes
. Téléchargez le progiciel d'installation du médiateur à partir de la page ONTAP Mediator.
+
https://mysupport.netapp.com/site/products/all/details/ontap-mediator/downloads-tab["Page de téléchargement du médiateur ONTAP"^]

. Vérifiez que le package d'installation du Mediator se trouve dans le répertoire de travail actuel :
+
`ls`

+
[listing]
----
[root@mediator-host ~]#ls
ontap-mediator-1.5.0.tgz
----
+

NOTE: Pour ONTAP Mediator versions 1.4 et antérieures, le programme d'installation est nommé `ontap-mediator`.

+
Si vous êtes à un endroit sans accès à Internet, vous devez vous assurer que le programme d'installation a accès aux packages requis.

. Si nécessaire, déplacez le package d'installation du Mediator du répertoire de téléchargement vers le répertoire d'installation de l'hôte Linux Mediator.
. Décompressez le programme d'installation : `tar xvfz ontap-mediator-1.5.0.tgz`
+
[listing]
----
[root@scs000099753 ~]# tar xvfz ontap-mediator-1.5.0.tgz
ontap-mediator-1.5.0/
ontap-mediator-1.5.0/ONTAP-Mediator-production.pub
ontap-mediator-1.5.0/tsa-prod-chain-ONTAP-Mediator.pem
ontap-mediator-1.5.0/tsa-prod-ONTAP-Mediator.pem
ontap-mediator-1.5.0/csc-prod-ONTAP-Mediator.pem
ontap-mediator-1.5.0/csc-prod-chain-ONTAP-Mediator.pem
ontap-mediator-1.5.0/ontap-mediator-1.5.0
ontap-mediator-1.5.0/ontap-mediator-1.5.0.sig.tsr
ontap-mediator-1.5.0/ontap-mediator-1.5.0.tsr
ontap-mediator-1.5.0/ontap-mediator-1.5.0.sig

----




== Vérifiez la signature du code du médiateur ONTAP

Vous devez vérifier la signature de code du médiateur ONTAP avant d'installer le progiciel d'installation du médiateur.

.Avant de commencer
Avant de vérifier la signature du code du médiateur, votre système doit répondre aux exigences suivantes.

* openssl versions 1.0.2 à 3.0 pour la vérification de base
* openssl version 1.1.0 ou ultérieure pour les opérations TSA (Time Stamping Authority)
* Accès public Internet pour vérification OCSP



NOTE: Le pack de téléchargement contient les fichiers suivants :

* `ONTAP-Mediator-development.pub` | la clé publique utilisée pour vérifier la signature
* `csc-prod-chain-ONTAP-Mediator.pem` | la chaîne de confiance de l'autorité de certification publique
* `csc-prod-ONTAP-Mediator.pem` | le certificat utilisé pour générer la clé
* `ontap-mediator-1.5.0` | le fichier exécutable d'installation du produit pour la version 1.5.0
* `ontap-mediator-1.5.0.sig` | le SHA-256 a été écrasé, puis signé par RSA à l'aide de la clé csc-prod, signature de l'installateur
* `ontap-mediator-1.5.0.sig.tsr` | la demande de révocation à utiliser par OCSCP pour la signature de l'installateur
* `tsa-prod-ONTAP-Mediator.pem` | le certificat public du TSR
* `tsa-prod-chain-ONTAP-Mediator.pem` | la chaîne de certificat public CA pour le TSR


.Étapes
. Effectuez la vérification de révocation sur `csc-prod-ONTAP-Mediator.pem` Via le protocole OCSP (Online Certificate Status Protocol).
+
.. Recherchez l'URL OCSP utilisée pour enregistrer le certificat car les certificats de développeur pourraient ne pas fournir d'uri.
+
[listing]
----
openssl x509 -noout -ocsp_uri -in csc-prod-chain-ONTAP-Mediator.pem
----
.. Générez une demande OCSP pour le certificat.
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -reqout req.der
----
.. Connectez-vous au OCSP Manager pour envoyer la demande OCSP : `openssl`
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -url ${ocsp_uri} -resp_text -respout resp.der
----


. Vérifiez la chaîne de confiance du CSC et sa date d'expiration par rapport à l'hôte local : `openssl verify`
+

NOTE: Le `openssl` La version du CHEMIN d'ACCÈS doit être valide `cert.pem` (pas auto-signé).

+
[listing]
----
openssl verify -untrusted csc-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} csc-prod-ONTAP-Mediator.pem  # Failure action: The Code-Signature-Check certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
openssl verify -untrusted tsa-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} tsa-prod-ONTAP-Mediator.pem  # Failure action: The Time-Stamp certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
----
. Vérifiez le `ontap-mediator-1.5.0.sig.tsr` et `ontap-mediator-1.5.0.tsr` fichiers utilisant les certificats associés : `openssl ts -verify`
+

NOTE: `.tsr` les fichiers contiennent la réponse de l'horodatage associée au programme d'installation et à la signature du code. Le traitement confirme que l'horodatage a une signature valide de TSA et que votre fichier d'entrée n'a pas changé. La vérification est effectuée localement sur votre machine. De façon indépendante, il n'est pas nécessaire d'accéder aux serveurs TSA.

+
[listing]
----
openssl ts -verify -data ontap-mediator-1.5.0.sig -in ontap-mediator-1.5.0.sig.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem
openssl ts -verify -data ontap-mediator-1.5.0 -in ontap-mediator-1.5.0.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem
----
. Vérifiez les signatures par rapport à la clé :  `openssl -dgst -verify`
+
[listing]
----
openssl dgst -sha256 -verify ONTAP-Mediator-production.pub -signature ontap-mediator-1.5.0.sig ontap-mediator-1.5.0
----


.Exemple de vérification de la signature de code du médiateur ONTAP (sortie de console)
[%collapsible]
====
[listing]
----
[root@scspa2695423001 ontap-mediator-1.5.0]# pwd
/root/ontap-mediator-1.5.0
[root@scspa2695423001 ontap-mediator-1.5.0]# ls -l
total 63660
-r--r--r-- 1 root root     8582 Oct 19 15:02 csc-prod-chain-ONTAP-Mediator.pem
-r--r--r-- 1 root root     2373 Oct 19 15:02 csc-prod-ONTAP-Mediator.pem
-r-xr-xr-- 1 root root 65132818 Oct 20 15:17 ontap-mediator-1.5.0
-rw-r--r-- 1 root root      384 Oct 20 15:17 ontap-mediator-1.5.0.sig
-rw-r--r-- 1 root root     5437 Oct 20 15:17 ontap-mediator-1.5.0.sig.tsr
-rw-r--r-- 1 root root     5436 Oct 20 15:17 ontap-mediator-1.5.0.tsr
-r--r--r-- 1 root root      625 Oct 19 15:02 ONTAP-Mediator-production.pub
-r--r--r-- 1 root root     3323 Oct 19 15:02 tsa-prod-chain-ONTAP-Mediator.pem
-r--r--r-- 1 root root     1740 Oct 19 15:02 tsa-prod-ONTAP-Mediator.pem
[root@scspa2695423001 ontap-mediator-1.5.0]#
[root@scspa2695423001 ontap-mediator-1.5.0]# /root/verify_ontap_mediator_signatures.sh
++ openssl version -d
++ cut -d '"' -f2
+ OPENSSLDIR=/etc/pki/tls
+ openssl version
OpenSSL 1.1.1k  FIPS 25 Mar 2021
++ openssl x509 -noout -ocsp_uri -in csc-prod-chain-ONTAP-Mediator.pem
+ ocsp_uri=http://ocsp.entrust.net
+ echo http://ocsp.entrust.net
http://ocsp.entrust.net
+ openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem -reqout req.der
+ openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem -url http://ocsp.entrust.net -resp_text -respout resp.der
OCSP Response Data:
    OCSP Response Status: successful (0x0)
    Response Type: Basic OCSP Response
    Version: 1 (0x0)
    Responder Id: C = US, O = "Entrust, Inc.", CN = Entrust Extended Validation Code Signing CA - EVCS2
    Produced At: Oct 28 05:01:00 2022 GMT
    Responses:
    Certificate ID:
      Hash Algorithm: sha1
      Issuer Name Hash: 69FA640329AB84E27220FE0927647B8194B91F2A
      Issuer Key Hash: CE894F8251AA15A28462CA312361D261FBF8FE78
      Serial Number: 511A542B57522AEB7295A640DC6200E5
    Cert Status: good
    This Update: Oct 28 05:00:00 2022 GMT
    Next Update: Nov  4 04:59:59 2022 GMT

    Signature Algorithm: sha512WithRSAEncryption
         3c:1d:49:b0:93:62:37:3e:c7:38:e3:9f:9f:62:82:73:ed:f4:
         ea:00:6b:f1:01:cd:79:57:92:f1:9d:5d:85:9b:60:59:f8:6c:
         e6:f4:50:51:f3:4c:8a:51:dd:50:68:16:8f:20:24:7e:39:b0:
         44:94:8d:b0:61:da:b9:08:36:74:2d:44:55:62:fb:92:be:4a:
         e7:6c:8c:49:dd:0c:fd:d8:ce:20:08:0d:0f:5a:29:a3:19:03:
         9f:d3:df:41:f4:89:0f:73:18:3f:ac:bb:a7:a3:96:7d:c5:70:
         4c:57:cd:17:17:c6:8a:60:d1:37:c9:2d:81:07:2a:d7:a6:02:
         ee:ce:88:16:22:db:e3:43:64:1e:9b:0d:4d:31:66:fa:ab:a5:
         52:99:94:4a:4a:d0:52:c5:34:f5:18:c7:15:5b:ce:74:c2:fc:
         61:ea:55:aa:f1:2f:82:a3:6a:95:8d:7e:2b:38:49:4f:bf:b1:
         68:7b:1b:24:8b:1f:4d:c5:77:f0:71:af:9c:34:c8:7a:82:50:
         09:a2:19:6e:c6:30:4f:da:a2:79:08:f9:d0:ff:85:d9:2a:84:
         cf:0c:aa:75:8f:72:c9:a7:a2:83:e8:8b:cf:ed:0c:69:75:b6:
         2a:7b:6b:58:99:01:d8:34:ad:e1:89:25:27:1b:fa:d9:6d:32:
         97:3a:0b:0a:8e:a3:9e:e3:f4:e0:d6:1a:c9:b5:14:8c:3e:54:
         3b:37:17:1a:93:44:84:8b:4a:87:97:1e:76:43:3e:d3:ec:8b:
         7e:56:4a:3f:01:31:c0:e5:58:fb:50:ce:6f:b1:e7:35:f9:b7:
         a3:ef:6b:3b:21:95:37:a6:5b:8f:f0:15:18:36:65:89:a1:9c:
         9b:69:00:b4:b1:65:6a:bc:11:2d:d4:9b:b4:97:cc:cb:7a:0c:
         16:11:c1:75:58:7e:13:ab:56:3c:3f:93:5b:95:24:c6:54:52:
         1f:86:a9:16:ce:d9:ea:8b:3a:f3:4f:c4:8f:ad:de:e8:3e:3c:
         d2:51:51:ad:33:7f:d8:c5:33:24:26:f1:2d:9d:0e:9f:55:d0:
         68:bf:af:bd:68:4a:40:08:bc:92:a0:62:54:7d:16:7b:36:29:
         15:b1:cd:58:8e:fb:4a:f2:3e:94:8b:fe:56:95:cc:24:32:af:
         5f:71:99:18:ed:0c:64:94:f7:54:48:87:48:d0:6d:b3:42:04:
         96:03:73:a2:8e:8a:6a:b2:af:ee:56:19:a1:c6:35:12:59:ad:
         19:6a:fe:e0:f1:27:cc:96:4e:f0:4f:fb:6a:bd:ce:05:2c:aa:
         79:7c:df:02:5c:ca:53:7d:60:12:88:7c:ce:15:c7:d4:02:27:
         c1:ab:cf:71:30:1e:14:ba
WARNING: no nonce in response
Response verify OK
csc-prod-ONTAP-Mediator.pem: good
        This Update: Oct 28 05:00:00 2022 GMT
        Next Update: Nov  4 04:59:59 2022 GMT
+ openssl verify -untrusted csc-prod-chain-ONTAP-Mediator.pem -CApath /etc/pki/tls csc-prod-ONTAP-Mediator.pem
csc-prod-ONTAP-Mediator.pem: OK
+ openssl verify -untrusted tsa-prod-chain-ONTAP-Mediator.pem -CApath /etc/pki/tls tsa-prod-ONTAP-Mediator.pem
tsa-prod-ONTAP-Mediator.pem: OK
+ openssl ts -verify -data ontap-mediator-1.5.0.sig -in ontap-mediator-1.5.0.sig.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem
Using configuration from /etc/pki/tls/openssl.cnf
Verification: OK
+ openssl ts -verify -data ontap-mediator-1.5.0 -in ontap-mediator-1.5.0.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem
Using configuration from /etc/pki/tls/openssl.cnf
Verification: OK
+ openssl dgst -sha256 -verify ONTAP-Mediator-production.pub -signature ontap-mediator-1.5.0.sig ontap-mediator-1.5.0
Verified OK
[root@scspa2695423001 ontap-mediator-1.5.0]#

----
====


== Installez le package d'installation du Mediator ONTAP

.Description de la tâche
* À partir de ONTAP Mediator 1.4, le mécanisme de démarrage sécurisé est activé sur les systèmes UEFI. Lorsque le démarrage sécurisé est activé, vous devez suivre les étapes supplémentaires pour enregistrer la clé de sécurité après l'installation :
+
** Suivez les instructions du fichier README : `/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/README.module-signing`Pour signer le module de noyau SCST.
** Repérez les touches requises : `/opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys`


+

NOTE: Une fois l'installation terminée, les fichiers README et l'emplacement des clés sont également fournis dans la sortie du système.



.Étapes
. Exécutez le programme d'installation et répondez aux invites si nécessaire : `./ontap-mediator-1.5.0/ontap-mediator-1.5.0 -y`
+
[listing]
----
[root@scs000099753 ~]# ./ontap-mediator-1.5.0/ontap-mediator-1.5.0 -y
----
+
Le processus d'installation permet de créer les comptes requis et d'installer les packages requis. Si une version antérieure de Mediator est installée sur l'hôte, vous serez invité à confirmer la mise à niveau.



.Exemple d'installation de ONTAP Mediator 1.5 (sortie de console)
[%collapsible]
====
[listing]
----
[root@scs000099753 ~]# ./ontap-mediator-1.5.0/ontap-mediator-1.5.0 -y
ONTAP Mediator: Self Extracting Installer


+ Extracting the ONTAP Mediator installation/upgrade archive
+ Performing the ONTAP Mediator run-time code signature check
   Using openssl from the path: /usr/bin/openssl configured for CApath:/etc/pki/tls

+ Unpacking the ONTAP Mediator installer
ONTAP Mediator requires two user accounts. One for the service (netapp), and one for use by ONTAP to the mediator API (mediatoradmin).
Using default account names: netapp + mediatoradmin

Enter ONTAP Mediator user account (mediatoradmin) password:

Re-Enter ONTAP Mediator user account (mediatoradmin) password:

+ Checking if SELinux is in enforcing mode


+ Checking for default Linux firewall
success
success
success


###############################################################
Preparing for installation of ONTAP Mediator packages.


+ Installing required packages.


Last metadata expiration check: 0:25:24 ago on Fri 21 Oct 2022 04:00:13 PM EDT.
Package openssl-1:1.1.1k-4.el8.x86_64 is already installed.
Package gcc-8.4.1-1.el8.x86_64 is already installed.
Package python36-3.6.8-2.module+el8.1.0+3334+5cb623d7.x86_64 is already installed.
Package libselinux-utils-2.9-5.el8.x86_64 is already installed.
Package perl-Data-Dumper-2.167-399.el8.x86_64 is already installed.
Package efibootmgr-16-1.el8.x86_64 is already installed.
Package mokutil-1:0.3.0-11.el8.x86_64 is already installed.
Package python3-pip-9.0.3-19.el8.noarch is already installed.
Package policycoreutils-python-utils-2.9-14.el8.noarch is already installed.
Dependencies resolved.
========================================================================================================================================================================================
 Package                                       Architecture            Version                                                  Repository                                         Size
========================================================================================================================================================================================
Installing:
 bzip2                                         x86_64                  1.0.6-26.el8                                             rhel-8-for-x86_64-baseos-rpms                      60 k
 elfutils-libelf-devel                         x86_64                  0.186-1.el8                                              rhel-8-for-x86_64-baseos-rpms                      60 k
 kernel-devel                                  x86_64                  4.18.0-348.el8                                           rhel-8-for-x86_64-baseos-rpms                      20 M
 make                                          x86_64                  1:4.2.1-11.el8                                           rhel-8-for-x86_64-baseos-rpms                     498 k
 openssl-devel                                 x86_64                  1:1.1.1k-7.el8_6                                         rhel-8-for-x86_64-baseos-rpms                     2.3 M
 patch                                         x86_64                  2.7.6-11.el8                                             rhel-8-for-x86_64-baseos-rpms                     138 k
 perl-ExtUtils-MakeMaker                       noarch                  1:7.34-1.el8                                             rhel-8-for-x86_64-appstream-rpms                  301 k
 python36-devel                                x86_64                  3.6.8-38.module+el8.5.0+12207+5c5719bc                   rhel-8-for-x86_64-appstream-rpms                   17 k
 redhat-lsb-core                               x86_64                  4.1-47.el8                                               rhel-8-for-x86_64-appstream-rpms                   45 k
Upgrading:
 cpp                                           x86_64                  8.5.0-10.1.el8_6                                         rhel-8-for-x86_64-appstream-rpms                   10 M
 elfutils-libelf                               x86_64                  0.186-1.el8                                              rhel-8-for-x86_64-baseos-rpms                     229 k
 elfutils-libs                                 x86_64                  0.186-1.el8                                              rhel-8-for-x86_64-baseos-rpms                     295 k
 gcc                                           x86_64                  8.5.0-10.1.el8_6                                         rhel-8-for-x86_64-appstream-rpms                   23 M
 libgcc                                        x86_64                  8.5.0-10.1.el8_6                                         rhel-8-for-x86_64-baseos-rpms                      80 k
 libgomp                                       x86_64                  8.5.0-10.1.el8_6                                         rhel-8-for-x86_64-baseos-rpms                     207 k
 libsemanage                                   x86_64                  2.9-8.el8                                                rhel-8-for-x86_64-baseos-rpms                     168 k
 mokutil                                       x86_64                  1:0.3.0-11.el8_6.1                                       rhel-8-for-x86_64-baseos-rpms                      46 k
 openssl                                       x86_64                  1:1.1.1k-7.el8_6                                         rhel-8-for-x86_64-baseos-rpms                     709 k
 openssl-libs                                  x86_64                  1:1.1.1k-7.el8_6                                         rhel-8-for-x86_64-baseos-rpms                     1.5 M
 platform-python-pip                           noarch                  9.0.3-22.el8                                             rhel-8-for-x86_64-baseos-rpms                     1.6 M
 policycoreutils                               x86_64                  2.9-19.el8                                               rhel-8-for-x86_64-baseos-rpms                     374 k
 policycoreutils-python-utils                  noarch                  2.9-19.el8                                               rhel-8-for-x86_64-baseos-rpms                     253 k
 python3-libsemanage                           x86_64                  2.9-8.el8                                                rhel-8-for-x86_64-baseos-rpms                     128 k
 python3-pip                                   noarch                  9.0.3-22.el8                                             rhel-8-for-x86_64-appstream-rpms                   20 k
 python3-policycoreutils                       noarch                  2.9-19.el8                                               rhel-8-for-x86_64-baseos-rpms                     2.2 M
 python36                                      x86_64                  3.6.8-38.module+el8.5.0+12207+5c5719bc                   rhel-8-for-x86_64-appstream-rpms                   19 k
Installing dependencies:
 annobin                                       x86_64                  10.29-3.el8                                              rhel-8-for-x86_64-appstream-rpms                  117 k
 at                                            x86_64                  3.1.20-11.el8                                            rhel-8-for-x86_64-baseos-rpms                      81 k
 bc                                            x86_64                  1.07.1-5.el8                                             rhel-8-for-x86_64-baseos-rpms                     129 k
 cups-client                                   x86_64                  1:2.2.6-38.el8                                           rhel-8-for-x86_64-appstream-rpms                  169 k
 dwz                                           x86_64                  0.12-10.el8                                              rhel-8-for-x86_64-appstream-rpms                  109 k
 ed                                            x86_64                  1.14.2-4.el8                                             rhel-8-for-x86_64-baseos-rpms                      82 k
 efi-srpm-macros                               noarch                  3-3.el8                                                  rhel-8-for-x86_64-appstream-rpms                   22 k
 esmtp                                         x86_64                  1.2-15.el8                                               EPEL-8                                             57 k
 ghc-srpm-macros                               noarch                  1.4.2-7.el8                                              rhel-8-for-x86_64-appstream-rpms                  9.4 k
 go-srpm-macros                                noarch                  2-17.el8                                                 rhel-8-for-x86_64-appstream-rpms                   13 k
 keyutils-libs-devel                           x86_64                  1.5.10-6.el8                                             rhel-8-for-x86_64-baseos-rpms                      48 k
 krb5-devel                                    x86_64                  1.18.2-14.el8                                            rhel-8-for-x86_64-baseos-rpms                     560 k
 libcom_err-devel                              x86_64                  1.45.6-2.el8                                             rhel-8-for-x86_64-baseos-rpms                      38 k
 libesmtp                                      x86_64                  1.0.6-18.el8                                             EPEL-8                                             70 k
 libkadm5                                      x86_64                  1.18.2-14.el8                                            rhel-8-for-x86_64-baseos-rpms                     187 k
 liblockfile                                   x86_64                  1.14-1.el8                                               rhel-8-for-x86_64-appstream-rpms                   32 k
 libselinux-devel                              x86_64                  2.9-5.el8                                                rhel-8-for-x86_64-baseos-rpms                     200 k
 libsepol-devel                                x86_64                  2.9-3.el8                                                rhel-8-for-x86_64-baseos-rpms                      87 k
 libverto-devel                                x86_64                  0.3.0-5.el8                                              rhel-8-for-x86_64-baseos-rpms                      18 k
 m4                                            x86_64                  1.4.18-7.el8                                             rhel-8-for-x86_64-baseos-rpms                     223 k
 mailx                                         x86_64                  12.5-29.el8                                              rhel-8-for-x86_64-baseos-rpms                     257 k
 ncurses-compat-libs                           x86_64                  6.1-9.20180224.el8                                       rhel-8-for-x86_64-baseos-rpms                     328 k
 ocaml-srpm-macros                             noarch                  5-4.el8                                                  rhel-8-for-x86_64-appstream-rpms                  9.5 k
 openblas-srpm-macros                          noarch                  2-2.el8                                                  rhel-8-for-x86_64-appstream-rpms                  8.0 k
 pcre2-devel                                   x86_64                  10.32-2.el8                                              rhel-8-for-x86_64-baseos-rpms                     605 k
 pcre2-utf16                                   x86_64                  10.32-2.el8                                              rhel-8-for-x86_64-baseos-rpms                     229 k
 pcre2-utf32                                   x86_64                  10.32-2.el8                                              rhel-8-for-x86_64-baseos-rpms                     220 k
 perl-CPAN-Meta-YAML                           noarch                  0.018-397.el8                                            rhel-8-for-x86_64-appstream-rpms                   34 k
 perl-ExtUtils-Command                         noarch                  1:7.34-1.el8                                             rhel-8-for-x86_64-appstream-rpms                   19 k
 perl-ExtUtils-Install                         noarch                  2.14-4.el8                                               rhel-8-for-x86_64-appstream-rpms                   46 k
 perl-ExtUtils-Manifest                        noarch                  1.70-395.el8                                             rhel-8-for-x86_64-appstream-rpms                   37 k
 perl-ExtUtils-ParseXS                         noarch                  1:3.35-2.el8                                             rhel-8-for-x86_64-appstream-rpms                   83 k
 perl-JSON-PP                                  noarch                  1:2.97.001-3.el8                                         rhel-8-for-x86_64-appstream-rpms                   68 k
 perl-Math-BigInt                              noarch                  1:1.9998.11-7.el8                                        rhel-8-for-x86_64-baseos-rpms                     196 k
 perl-Math-Complex                             noarch                  1.59-421.el8                                             rhel-8-for-x86_64-baseos-rpms                     109 k
 perl-Test-Harness                             noarch                  1:3.42-1.el8                                             rhel-8-for-x86_64-appstream-rpms                  279 k
 perl-devel                                    x86_64                  4:5.26.3-419.el8_4.1                                     rhel-8-for-x86_64-appstream-rpms                  599 k
 perl-srpm-macros                              noarch                  1-25.el8                                                 rhel-8-for-x86_64-appstream-rpms                   11 k
 perl-version                                  x86_64                  6:0.99.24-1.el8                                          rhel-8-for-x86_64-appstream-rpms                   67 k
 platform-python-devel                         x86_64                  3.6.8-41.el8                                             rhel-8-for-x86_64-appstream-rpms                  249 k
 python-rpm-macros                             noarch                  3-41.el8                                                 rhel-8-for-x86_64-appstream-rpms                   15 k
 python-srpm-macros                            noarch                  3-41.el8                                                 rhel-8-for-x86_64-appstream-rpms                   15 k
 python3-pyparsing                             noarch                  2.1.10-7.el8                                             rhel-8-for-x86_64-baseos-rpms                     142 k
 python3-rpm-generators                        noarch                  5-7.el8                                                  rhel-8-for-x86_64-appstream-rpms                   25 k
 python3-rpm-macros                            noarch                  3-41.el8                                                 rhel-8-for-x86_64-appstream-rpms                   14 k
 qt5-srpm-macros                               noarch                  5.15.2-1.el8                                             rhel-8-for-x86_64-appstream-rpms                   11 k
 redhat-lsb-submod-security                    x86_64                  4.1-47.el8                                               rhel-8-for-x86_64-appstream-rpms                   22 k
 redhat-rpm-config                             noarch                  125-1.el8                                                rhel-8-for-x86_64-appstream-rpms                   87 k
 rust-srpm-macros                              noarch                  5-2.el8                                                  rhel-8-for-x86_64-appstream-rpms                  9.3 k
 spax                                          x86_64                  1.5.3-13.el8                                             rhel-8-for-x86_64-baseos-rpms                     217 k
 systemtap-sdt-devel                           x86_64                  4.6-4.el8                                                rhel-8-for-x86_64-appstream-rpms                   86 k
 time                                          x86_64                  1.9-3.el8                                                rhel-8-for-x86_64-baseos-rpms                      54 k
 unzip                                         x86_64                  6.0-46.el8                                               rhel-8-for-x86_64-baseos-rpms                     196 k
 util-linux-user                               x86_64                  2.32.1-28.el8                                            rhel-8-for-x86_64-baseos-rpms                     100 k
 zip                                           x86_64                  3.0-23.el8                                               rhel-8-for-x86_64-baseos-rpms                     270 k
 zlib-devel                                    x86_64                  1.2.11-17.el8                                            rhel-8-for-x86_64-baseos-rpms                      58 k
Installing weak dependencies:
 perl-CPAN-Meta                                noarch                  2.150010-396.el8                                         rhel-8-for-x86_64-appstream-rpms                  191 k
 perl-CPAN-Meta-Requirements                   noarch                  2.140-396.el8                                            rhel-8-for-x86_64-appstream-rpms                   37 k
 perl-Encode-Locale                            noarch                  1.05-10.module+el8.3.0+6498+9eecfe51                     rhel-8-for-x86_64-appstream-rpms                   22 k
 perl-Time-HiRes                               x86_64                  4:1.9758-2.el8                                           rhel-8-for-x86_64-appstream-rpms                   61 k

Transaction Summary
========================================================================================================================================================================================
Install  69 Packages
Upgrade  17 Packages

Total download size: 72 M
Is this ok [y/N]: y
Downloading Packages:
(1/86): perl-ExtUtils-Install-2.14-4.el8.noarch.rpm                                                                                                     735 kB/s |  46 kB     00:00
(2/86): libesmtp-1.0.6-18.el8.x86_64.rpm                                                                                                                1.0 MB/s |  70 kB     00:00
(3/86): esmtp-1.2-15.el8.x86_64.rpm                                                                                                                     747 kB/s |  57 kB     00:00
(4/86): rust-srpm-macros-5-2.el8.noarch.rpm                                                                                                             308 kB/s | 9.3 kB     00:00
(5/86): perl-ExtUtils-Manifest-1.70-395.el8.noarch.rpm                                                                                                  781 kB/s |  37 kB     00:00
(6/86): perl-CPAN-Meta-2.150010-396.el8.noarch.rpm                                                                                                      2.7 MB/s | 191 kB     00:00
(7/86): ocaml-srpm-macros-5-4.el8.noarch.rpm                                                                                                            214 kB/s | 9.5 kB     00:00
(8/86): perl-JSON-PP-2.97.001-3.el8.noarch.rpm                                                                                                          1.2 MB/s |  68 kB     00:00
(9/86): perl-ExtUtils-MakeMaker-7.34-1.el8.noarch.rpm                                                                                                   5.8 MB/s | 301 kB     00:00
(10/86): ghc-srpm-macros-1.4.2-7.el8.noarch.rpm                                                                                                         317 kB/s | 9.4 kB     00:00
(11/86): perl-Test-Harness-3.42-1.el8.noarch.rpm                                                                                                        4.5 MB/s | 279 kB     00:00
(12/86): perl-ExtUtils-Command-7.34-1.el8.noarch.rpm                                                                                                    520 kB/s |  19 kB     00:00

...
                                                                                                         15 MB/s | 1.5 MB     00:00
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Total                                                                                                                                                    35 MB/s |  72 MB     00:02
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                                                                                                                                1/1
  Running scriptlet: openssl-libs-1:1.1.1k-7.el8_6.x86_64                                                                                                                           1/1
  Upgrading        : openssl-libs-1:1.1.1k-7.el8_6.x86_64                                                                                                                         1/103
  Running scriptlet: openssl-libs-1:1.1.1k-7.el8_6.x86_64                                                                                                                         1/103
  Upgrading        : libgcc-8.5.0-10.1.el8_6.x86_64                                                                                                                               2/103
  Running scriptlet: libgcc-8.5.0-10.1.el8_6.x86_64                                                                                                                               2/103
  Upgrading        : elfutils-libelf-0.186-1.el8.x86_64                                                                                                                           3/103
  Installing       : perl-version-6:0.99.24-1.el8.x86_64                                                                                                                          4/103
  Installing       : perl-CPAN-Meta-Requirements-2.140-396.el8.noarch                                                                                                             5/103
  Upgrading        : libsemanage-2.9-8.el8.x86_64                                                                                                                                 6/103
  Installing       : zlib-devel-1.2.11-17.el8.x86_64                                                                                                                              7/103
  Installing       : python-srpm-macros-3-41.el8.noarch                                                                                                                           8/103
  Installing       : python-rpm-macros-3-41.el8.noarch                                                                                                                            9/103
  Installing       : python3-rpm-macros-3-41.el8.noarch                                                                                                                          10/103
  Installing       : perl-Time-HiRes-4:1.9758-2.el8.x86_64                                                                                                                       11/103
  Installing       : perl-ExtUtils-ParseXS-1:3.35-2.el8.noarch                                                                                                                   12/103
  Installing       : perl-Test-Harness-1:3.42-1.el8.noarch                                                                                                                       13/103
  Upgrading        : python3-libsemanage-2.9-8.el8.x86_64                                                                                                                        14/103
  Upgrading        : policycoreutils-2.9-19.el8.x86_64                                                                                                                           15/103
  Running scriptlet: policycoreutils-2.9-19.el8.x86_64                                                                                                                           15/103
  Upgrading        : python3-policycoreutils-2.9-19.el8.noarch                                                                                                                   16/103
  Installing       : dwz-0.12-10.el8.x86_64                                                                                                                                      17/103
  Installing       : ncurses-compat-libs-6.1-9.20180224.el8.x86_64                                                                                                               18/103
  Installing       : libesmtp-1.0.6-18.el8.x86_64                                                                                                                                19/103
  Installing       : mailx-12.5-29.el8.x86_64                                                                                                                                    20/103
  Installing       : libkadm5-1.18.2-14.el8.x86_64                                                                                                                               21/103
  Upgrading        : libgomp-8.5.0-10.1.el8_6.x86_64                                                                                                                             22/103
  Running scriptlet: libgomp-8.5.0-10.1.el8_6.x86_64                                                                                                                             22/103
  Upgrading        : platform-python-pip-9.0.3-22.el8.noarch                                                                                                                     23/103
  Upgrading        : python3-pip-9.0.3-22.el8.noarch                                                                                                                             24/103
  Upgrading        : python36-3.6.8-38.module+el8.5.0+12207+5c5719bc.x86_64                                                                                                      25/103
  Running scriptlet: python36-3.6.8-38.module+el8.5.0+12207+5c5719bc.x86_64                                                                                                      25/103
  Upgrading        : cpp-8.5.0-10.1.el8_6.x86_64                                                                                                                                 26/103
  Running scriptlet: cpp-8.5.0-10.1.el8_6.x86_64                                                                                                                                 26/103
  Upgrading        : gcc-8.5.0-10.1.el8_6.x86_64                                                                                                                                 27/103
  Running scriptlet: gcc-8.5.0-10.1.el8_6.x86_64                                                                                                                                 27/103
  Installing       : annobin-10.29-3.el8.x86_64                                                                                                                                  28/103
  Installing       : unzip-6.0-46.el8.x86_64                                                                                                                                     29/103
  Installing       : zip-3.0-23.el8.x86_64                                                                                                                                       30/103
  Installing       : perl-Math-Complex-1.59-421.el8.noarch                                                                                                                       31/103
  Installing       : perl-Math-BigInt-1:1.9998.11-7.el8.noarch                                                                                                                   32/103
  Installing       : perl-JSON-PP-1:2.97.001-3.el8.noarch                                                                                                                        33/103
  Installing       : make-1:4.2.1-11.el8.x86_64                                                                                                                                  34/103
  Running scriptlet: make-1:4.2.1-11.el8.x86_64                                                                                                                                  34/103
  Installing       : libcom_err-devel-1.45.6-2.el8.x86_64                                                                                                                        35/103
  Installing       : util-linux-user-2.32.1-28.el8.x86_64                                                                                                                        36/103
  Installing       : libsepol-devel-2.9-3.el8.x86_64                                                                                                                             37/103
  Installing       : pcre2-utf32-10.32-2.el8.x86_64                                                                                                                              38/103
  Installing       : pcre2-utf16-10.32-2.el8.x86_64                                                                                                                              39/103
  Installing       : pcre2-devel-10.32-2.el8.x86_64                                                                                                                              40/103
  Installing       : libselinux-devel-2.9-5.el8.x86_64                                                                                                                           41/103
  Installing       : patch-2.7.6-11.el8.x86_64                                                                                                                                   42/103
  Installing       : python3-pyparsing-2.1.10-7.el8.noarch                                                                                                                       43/103
  Installing       : systemtap-sdt-devel-4.6-4.el8.x86_64                                                                                                                        44/103
  Installing       : spax-1.5.3-13.el8.x86_64                                                                                                                                    45/103
  Running scriptlet: spax-1.5.3-13.el8.x86_64                                                                                                                                    45/103
  Installing       : m4-1.4.18-7.el8.x86_64                                                                                                                                      46/103
  Running scriptlet: m4-1.4.18-7.el8.x86_64                                                                                                                                      46/103
  Installing       : libverto-devel-0.3.0-5.el8.x86_64                                                                                                                           47/103
  Installing       : bc-1.07.1-5.el8.x86_64                                                                                                                                      48/103
  Running scriptlet: bc-1.07.1-5.el8.x86_64                                                                                                                                      48/103
  Installing       : at-3.1.20-11.el8.x86_64                                                                                                                                     49/103
  Running scriptlet: at-3.1.20-11.el8.x86_64                                                                                                                                     49/103
  Installing       : keyutils-libs-devel-1.5.10-6.el8.x86_64                                                                                                                     50/103
  Installing       : krb5-devel-1.18.2-14.el8.x86_64                                                                                                                             51/103
  Installing       : time-1.9-3.el8.x86_64                                                                                                                                       52/103
  Running scriptlet: time-1.9-3.el8.x86_64                                                                                                                                       52/103

  Upgrading        : policycoreutils-python-utils-2.9-19.el8.noarch                                                                                                              80/103
  Installing       : elfutils-libelf-devel-0.186-1.el8.x86_64                                                                                                                    81/103
  Upgrading        : elfutils-libs-0.186-1.el8.x86_64                                                                                                                            82/103
  Upgrading        : mokutil-1:0.3.0-11.el8_6.1.x86_64                                                                                                                           83/103
  Upgrading        : openssl-1:1.1.1k-7.el8_6.x86_64                                                                                                                             84/103
  Installing       : kernel-devel-4.18.0-348.el8.x86_64                                                                                                                          85/103
  Running scriptlet: kernel-devel-4.18.0-348.el8.x86_64

  ...
                                                                                                                       85/103
  Installing       : bzip2-1.0.6-26.el8.x86_64                                                                                                                                   86/103
  Cleanup          : policycoreutils-python-utils-2.9-14.el8.noarch                                                                                                              87/103
  Cleanup          : python3-policycoreutils-2.9-14.el8.noarch                                                                                                                   88/103
  Cleanup          : python36-3.6.8-2.module+el8.1.0+3334+5cb623d7.x86_64                                                                                                        89/103
  Running scriptlet: python36-3.6.8-2.module+el8.1.0+3334+5cb623d7.x86_64                                                                                                        89/103
  Cleanup          : elfutils-libs-0.185-1.el8.x86_64                                                                                                                            90/103
  Cleanup          : openssl-1:1.1.1k-4.el8.x86_64                                                                                                                               91/103
  Cleanup          : python3-libsemanage-2.9-6.el8.x86_64                                                                                                                        92/103
  Running scriptlet: gcc-8.4.1-1.el8.x86_64                                                                                                                                      93/103
  Cleanup          : gcc-8.4.1-1.el8.x86_64                                                                                                                                      93/103
  Running scriptlet: policycoreutils-2.9-14.el8.x86_64                                                                                                                           94/103
  Cleanup          : policycoreutils-2.9-14.el8.x86_64                                                                                                                           94/103
  Cleanup          : mokutil-1:0.3.0-11.el8.x86_64                                                                                                                               95/103
  Cleanup          : python3-pip-9.0.3-19.el8.noarch                                                                                                                             96/103
  Cleanup          : platform-python-pip-9.0.3-19.el8.noarch                                                                                                                     97/103
  Cleanup          : openssl-libs-1:1.1.1k-4.el8.x86_64                                                                                                                          98/103
  Running scriptlet: openssl-libs-1:1.1.1k-4.el8.x86_64                                                                                                                          98/103
  Cleanup          : libsemanage-2.9-6.el8.x86_64                                                                                                                                99/103
  Running scriptlet: cpp-8.4.1-1.el8.x86_64                                                                                                                                     100/103
  Cleanup          : cpp-8.4.1-1.el8.x86_64                                                                                                                                     100/103
  Cleanup          : libgcc-8.5.0-3.el8.x86_64                                                                                                                                  101/103
  Running scriptlet: libgcc-8.5.0-3.el8.x86_64                                                                                                                                  101/103
  Running scriptlet: libgomp-8.4.1-1.el8.x86_64                                                                                                                                 102/103
  Cleanup          : libgomp-8.4.1-1.el8.x86_64                                                                                                                                 102/103
  Running scriptlet: libgomp-8.4.1-1.el8.x86_64                                                                                                                                 102/103
  Cleanup          : elfutils-libelf-0.185-1.el8.x86_64                                                                                                                         103/103
  Running scriptlet: elfutils-libelf-0.185-1.el8.x86_64                                                                                                                         103/103
  Verifying        : esmtp-1.2-15.el8.x86_64                                                                                                                                      1/103
  Verifying        : libesmtp-1.0.6-18.el8.x86_64

  ...

Upgraded:
  cpp-8.5.0-10.1.el8_6.x86_64                              elfutils-libelf-0.186-1.el8.x86_64     elfutils-libs-0.186-1.el8.x86_64          gcc-8.5.0-10.1.el8_6.x86_64
  libgcc-8.5.0-10.1.el8_6.x86_64                           libgomp-8.5.0-10.1.el8_6.x86_64        libsemanage-2.9-8.el8.x86_64              mokutil-1:0.3.0-11.el8_6.1.x86_64
  openssl-1:1.1.1k-7.el8_6.x86_64                          openssl-libs-1:1.1.1k-7.el8_6.x86_64   platform-python-pip-9.0.3-22.el8.noarch   policycoreutils-2.9-19.el8.x86_64
  policycoreutils-python-utils-2.9-19.el8.noarch           python3-libsemanage-2.9-8.el8.x86_64   python3-pip-9.0.3-22.el8.noarch           python3-policycoreutils-2.9-19.el8.noarch
  python36-3.6.8-38.module+el8.5.0+12207+5c5719bc.x86_64
Installed:
  annobin-10.29-3.el8.x86_64                                        at-3.1.20-11.el8.x86_64                             bc-1.07.1-5.el8.x86_64
  bzip2-1.0.6-26.el8.x86_64                                         cups-client-1:2.2.6-38.el8.x86_64                   dwz-0.12-10.el8.x86_64
  ed-1.14.2-4.el8.x86_64                                            efi-srpm-macros-3-3.el8.noarch                      elfutils-libelf-devel-0.186-1.el8.x86_64
  esmtp-1.2-15.el8.x86_64                                           ghc-srpm-macros-1.4.2-7.el8.noarch                  go-srpm-macros-2-17.el8.noarch
  kernel-devel-4.18.0-348.el8.x86_64                                keyutils-libs-devel-1.5.10-6.el8.x86_64             krb5-devel-1.18.2-14.el8.x86_64
  libcom_err-devel-1.45.6-2.el8.x86_64                              libesmtp-1.0.6-18.el8.x86_64                        libkadm5-1.18.2-14.el8.x86_64
  liblockfile-1.14-1.el8.x86_64                                     libselinux-devel-2.9-5.el8.x86_64                   libsepol-devel-2.9-3.el8.x86_64
  libverto-devel-0.3.0-5.el8.x86_64                                 m4-1.4.18-7.el8.x86_64                              mailx-12.5-29.el8.x86_64
  make-1:4.2.1-11.el8.x86_64                                        ncurses-compat-libs-6.1-9.20180224.el8.x86_64       ocaml-srpm-macros-5-4.el8.noarch
  openblas-srpm-macros-2-2.el8.noarch                               openssl-devel-1:1.1.1k-7.el8_6.x86_64               patch-2.7.6-11.el8.x86_64
  pcre2-devel-10.32-2.el8.x86_64                                    pcre2-utf16-10.32-2.el8.x86_64                      pcre2-utf32-10.32-2.el8.x86_64
  perl-CPAN-Meta-2.150010-396.el8.noarch                            perl-CPAN-Meta-Requirements-2.140-396.el8.noarch    perl-CPAN-Meta-YAML-0.018-397.el8.noarch
  perl-Encode-Locale-1.05-10.module+el8.3.0+6498+9eecfe51.noarch    perl-ExtUtils-Command-1:7.34-1.el8.noarch           perl-ExtUtils-Install-2.14-4.el8.noarch
  perl-ExtUtils-MakeMaker-1:7.34-1.el8.noarch                       perl-ExtUtils-Manifest-1.70-395.el8.noarch          perl-ExtUtils-ParseXS-1:3.35-2.el8.noarch
  perl-JSON-PP-1:2.97.001-3.el8.noarch                              perl-Math-BigInt-1:1.9998.11-7.el8.noarch           perl-Math-Complex-1.59-421.el8.noarch
  perl-Test-Harness-1:3.42-1.el8.noarch                             perl-Time-HiRes-4:1.9758-2.el8.x86_64               perl-devel-4:5.26.3-419.el8_4.1.x86_64
  perl-srpm-macros-1-25.el8.noarch                                  perl-version-6:0.99.24-1.el8.x86_64                 platform-python-devel-3.6.8-41.el8.x86_64
  python-rpm-macros-3-41.el8.noarch                                 python-srpm-macros-3-41.el8.noarch                  python3-pyparsing-2.1.10-7.el8.noarch
  python3-rpm-generators-5-7.el8.noarch                             python3-rpm-macros-3-41.el8.noarch                  python36-devel-3.6.8-38.module+el8.5.0+12207+5c5719bc.x86_64
  qt5-srpm-macros-5.15.2-1.el8.noarch                               redhat-lsb-core-4.1-47.el8.x86_64                   redhat-lsb-submod-security-4.1-47.el8.x86_64
  redhat-rpm-config-125-1.el8.noarch                                rust-srpm-macros-5-2.el8.noarch                     spax-1.5.3-13.el8.x86_64
  systemtap-sdt-devel-4.6-4.el8.x86_64                              time-1.9-3.el8.x86_64                               unzip-6.0-46.el8.x86_64
  util-linux-user-2.32.1-28.el8.x86_64                              zip-3.0-23.el8.x86_64                               zlib-devel-1.2.11-17.el8.x86_64

Complete!
OS package installations finished
+ Installing ONTAP Mediator. (Log: /tmp/ontap_mediator.JixKGP/ontap-mediator-1.5.0/ontap-mediator-1.5.0/install_20221021155929.log)
    This step will take several minutes. Use the log file to view progress.
    Sudoer config verified
    ONTAP Mediator rsyslog and logging rotation enabled
+ Install successful. (Moving log to /opt/netapp/lib/ontap_mediator/log/install_20221021155929.log)
+ WARNING: This system supports UEFI
           Secure Boot (SB) is currently disabled on this system.
           If SB is enabled in the future, SCST will not work unless the following action is taken:
           Using the keys in /opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys follow
           instructions in /opt/netapp/lib/ontap_mediator/ontap_mediator/SCST_mod_keys/README.module-signing
           to sign the SCST kernel module. Note that reboot will be needed.
     SCST will not start automatically when Secure Boot is enabled and not configured properly.
+ Note: ONTAP Mediator uses a kernel module compiled specifically for the current
        OS. Using 'yum update' to upgrade the kernel might cause service interruption.
    For more information, see /opt/netapp/lib/ontap_mediator/README
[root@scs000099753 ~]# cat /etc/redhat-release
Red Hat Enterprise Linux release 8.5 (Ootpa)
[root@scs000099753 ~]#

----
====


== Vérifiez l'installation

.Étapes
. Exécutez les commandes suivantes pour afficher l'état des services du médiateur ONTAP :
+
.. Exécuter : `systemctl status ontap_mediator`
+
[listing]
----
[root@scspr1915530002 ~]# systemctl status ontap_mediator

 ontap_mediator.service - ONTAP Mediator
Loaded: loaded (/etc/systemd/system/ontap_mediator.service; enabled; vendor preset: disabled)
Active: active (running) since Mon 2022-04-18 10:41:49 EDT; 1 weeks 0 days ago
Process: 286710 ExecStop=/bin/kill -s INT $MAINPID (code=exited, status=0/SUCCESS)
Main PID: 286712 (uwsgi)
Status: "uWSGI is ready"
Tasks: 3 (limit: 49473)
Memory: 139.2M
CGroup: /system.slice/ontap_mediator.service
      ├─286712 /opt/netapp/lib/ontap_mediator/pyenv/bin/uwsgi --ini /opt/netapp/lib/ontap_mediator/uwsgi/ontap_mediator.ini
      ├─286716 /opt/netapp/lib/ontap_mediator/pyenv/bin/uwsgi --ini /opt/netapp/lib/ontap_mediator/uwsgi/ontap_mediator.ini
      └─286717 /opt/netapp/lib/ontap_mediator/pyenv/bin/uwsgi --ini /opt/netapp/lib/ontap_mediator/uwsgi/ontap_mediator.ini

[root@scspr1915530002 ~]#
----
.. Exécuter : `systemctl status mediator-scst`
+
[listing]
----
[root@scspr1915530002 ~]# systemctl status mediator-scst
   Loaded: loaded (/etc/systemd/system/mediator-scst.service; enabled; vendor preset: disabled)
   Active: active (running) since Mon 2022-04-18 10:41:47 EDT; 1 weeks 0 days ago
  Process: 286595 ExecStart=/etc/init.d/scst start (code=exited, status=0/SUCCESS)
 Main PID: 286662 (iscsi-scstd)
    Tasks: 1 (limit: 49473)
   Memory: 1.2M
   CGroup: /system.slice/mediator-scst.service
           └─286662 /usr/local/sbin/iscsi-scstd

[root@scspr1915530002 ~]#
----


. Vérifiez que les ports utilisés par le service ONTAP Mediator sont les suivants : `netstat`
+
[listing]
----
[root@scspr1905507001 ~]# netstat -anlt | grep -E '3260|31784'

         tcp   0   0 0.0.0.0:31784   0.0.0.0:*      LISTEN

         tcp   0   0 0.0.0.0:3260    0.0.0.0:*      LISTEN

         tcp6  0   0 :::3260         :::*           LISTEN
----




== Résultat

Le service ONTAP Mediator est maintenant installé et en cours d'exécution. Une autre configuration doit être effectuée dans le système de stockage ONTAP pour utiliser les fonctions du médiateur :

* Pour utiliser le service médiateur ONTAP dans une configuration IP MetroCluster, reportez-vous à la section link:https://docs.netapp.com/us-en/ontap-metrocluster/install-ip/task_configuring_the_ontap_mediator_service_from_a_metrocluster_ip_configuration.html["Configuration du service médiateur ONTAP à partir d'une configuration IP MetroCluster"^]
* Pour utiliser SnapMirror Business Continuity, voir link:https://docs.netapp.com/us-en/ontap/smbc/smbc_install_confirm_ontap_cluster.html["Installez le service médiateur ONTAP et confirmez la configuration du cluster ONTAP"^]

