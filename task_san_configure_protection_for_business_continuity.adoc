---
sidebar: sidebar 
permalink: task_san_configure_protection_for_business_continuity.html 
keywords: SM-BC, snapmirror business continuity, consistency group, remote protection, 9.8, 9.9.1, destination 
summary: 'La configuration de la protection pour la continuité de l"activité implique de sélectionner des LUN sur le cluster ONTAP source et de les ajouter à un groupe de cohérence.' 
---
= Protégez-vous avec la continuité de l'activité SnapMirror
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Configurer la protection à l'aide de SnapMirror Business Continuity implique de sélectionner des LUN sur le cluster source ONTAP et de les ajouter à un groupe de cohérence.

.Avant de commencer
* Vous devez disposer d'une licence SnapMirror synchrone.
* Vous devez être un administrateur de cluster ou de machines virtuelles de stockage.
* Tous les volumes constitutifs d'un groupe de cohérence doivent se trouver dans une seule VM de stockage (SVM).
+
** Les LUN peuvent résider sur des volumes différents.


* Le cluster source et le cluster destination ne peuvent pas être identiques.
* Vous ne pouvez pas établir de relations de groupe de cohérence SM-BC entre les clusters ASA et les clusters non ASA.
* L'IPspace par défaut est requis par SM-BC pour les relations cluster peer-to-peer. L'IPspace personnalisé n'est pas pris en charge.
* Le nom du groupe de cohérence doit être unique.
* Les volumes du cluster secondaire (destination) doivent être de type DP.
* Les SVM primaire et secondaire doivent être en relation de peering.


.Étapes
Vous pouvez configurer un groupe de cohérence via l'interface de ligne de commandes ONTAP ou System Manager.

Depuis ONTAP 9.10.1, ONTAP propose un menu et un terminal de groupe de cohérence dans System Manager, ainsi que des utilitaires de gestion supplémentaires. Si vous utilisez ONTAP 9.10.1 ou une version ultérieure, reportez-vous à la section link:./consistency-groups/configure-task.html["Configurer un groupe de cohérence"] ensuite link:./consistency-groups/protect-task.html["configurer la protection"] Pour créer une relation SM-BC.

[role="tabbed-block"]
====
.System Manager
--
. Sur le cluster principal, accédez à *protection > Présentation > protéger pour la continuité de l'activité > protéger les LUN*.
. Sélectionnez les LUN que vous souhaitez protéger et ajoutez-les à un groupe de protection.
. Sélectionner le cluster de destination et le SVM.
. *Initialize relation* est sélectionné par défaut. Cliquez sur *Save* pour commencer la protection.
. Accédez à *Tableau de bord > performances* pour vérifier l'activité IOPS des LUN.
. Sur le cluster de destination, utilisez System Manager pour vérifier que la protection de la relation de continuité de l'activité est en mode synchrone : *protection > relations*.


--
.CLI
--
. Créez une relation de groupe de cohérence à partir du cluster destination.
`destinatio:> snapmirror create -source-path _source-path_ -destination-path _destination-path_ -cg-item-mappings _volume-paths_ -policy _policy-name_
+
Vous pouvez mapper jusqu'à 12 volumes constitutifs à l'aide du `cg-item-mappings` sur le `snapmirror create` commande.

+
La création de deux groupes de cohérence dans l'exemple suivant : `cg_src_ on the source with `vol1` et `vol2` et un groupe de cohérence de destination en miroir, `cg_dst`.

+
`destination::> snapmirror create -source-path vs1_src:/cg/cg_src -destination-path vs1_dst:/cg/cg_dst -cg-item-mappings vol_src1:@vol_dst1,vol_src2:@vol_dst2 -policy AutomatedFailOver`

. Depuis le cluster de destination, initialisez le groupe de cohérence.
+
`destination::>snapmirror initialize -destination-path _destination-consistency-group_`

. Confirmer que l'opération d'initialisation a réussi. Le statut doit être de `InSync`.
+
`snapmirror show`

. Sur chaque cluster, créez un groupe initiateur afin de mapper les LUN sur l'initiateur de l'hôte d'application.
`lun igroup create -igroup _name_ -protocol _fcp|iscsi_ -ostype _os_ -initiator _initiator_name_`
. Sur chaque cluster, mappez les LUN sur le groupe initiateur :
+
`lun map -path _path_name_ -igroup _igroup_name_`

. Vérifiez que le mappage de LUN a réussi avec le `lun map` commande. Vous pouvez ensuite détecter les nouveaux LUN sur l'hôte d'application.


--
====