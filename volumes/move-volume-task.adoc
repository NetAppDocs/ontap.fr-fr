---
permalink: volumes/move-volume-task.html 
sidebar: sidebar 
keywords: move, volume 
summary: 'Déplacez un FlexVol volume vers un autre agrégat, nœud ou les deux au sein du même SVM afin d"équilibrer la capacité de stockage.' 
---
= Déplacer un volume ONTAP
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Vous pouvez déplacer un volume FlexVol vers un autre agrégat, nœud ou les deux au sein d'un même SVM afin d'équilibrer la capacité de stockage après avoir déterminé qu'il existe un déséquilibre de la capacité de stockage.

.Description de la tâche
Par défaut, si l'opération de mise en service ne s'effectue pas dans les 30 secondes, il est à nouveau possible de procéder à une nouvelle tentative. Vous pouvez régler le comportement par défaut à l'aide des `-cutover-window` paramètres et `-cutover-action`, qui nécessitent tous deux un accès de niveau de privilège avancé.

Vous devez être un administrateur de cluster pour effectuer cette tâche.

.Avant de commencer
* Si vous déplacez un volume qui utilise la compression adaptative 8K vers l'une des plates-formes suivantes, vous devezlink:increase-volume-active-file-system-size.html["augmenter la taille du système de fichiers actif du volume"] avant de déplacer le volume.  Les données sont compressées différemment sur ces plateformes afin que l'espace soit économisé au niveau agrégé plutôt qu'au niveau du volume.  En raison de cette différence, la taille du système de fichiers actif du volume doit être augmentée du montant des économies de compression de 8 Ko pour éviter que le volume ne manque d'espace pendant le déplacement du volume.
+
** Plateformes AFF et FAS prenant en charge l'efficacité du stockage du processeur de déchargement dédié
+
En savoir plus sur les plateformes AFF et FAS qui prennent en chargelink:../concepts/builtin-storage-efficiency-concept.html["efficacité du stockage du processeur de déchargement dédié"] .

** Plateformes AFF série C
+
Voir lelink:https://hwu.netapp.com/["Hardware Universe"^] pour une liste complète des plates-formes de la série C.



* Si vous déplacez un miroir de protection des données et que vous n'avez pas initialisé la relation miroir, utilisez le `snapmirror initialize` commande pour initialiser la relation miroir. En savoir plus sur  `snapmirror initialize` dans le link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-initialize.html["Référence de commande ONTAP"^] .
+
Les relations de miroir de protection des données doivent être initialisées avant de déplacer l'un des volumes.



.Étapes
. Déterminez un agrégat vers lequel vous pouvez déplacer le volume :
+
[source, cli]
----
volume move target-aggr show
----
+
L'agrégat que vous sélectionnez doit avoir suffisamment d'espace pour le volume, c'est-à-dire que la taille disponible est supérieure au volume que vous déplacez.

+
L'exemple suivant montre que le volume vs2 peut être déplacé vers l'un des agrégats répertoriés :

+
[listing]
----
cluster1::> volume move target-aggr show -vserver vs2 -volume user_max
Aggregate Name   Available Size   Storage Type
--------------   --------------   ------------
aggr2            467.9GB          hdd
node12a_aggr3    10.34GB          hdd
node12a_aggr2    10.36GB          hdd
node12a_aggr1    10.36GB          hdd
node12a_aggr4    10.36GB          hdd
5 entries were displayed.
----
+
Pour en savoir plus, `volume move target-aggr show` consultez le link:https://docs.netapp.com/us-en/ontap-cli/volume-move-target-aggr-show.html["Référence de commande ONTAP"^].

. Effectuez une vérification de validation pour vérifier que le volume peut être déplacé vers l'agrégat prévu :
+
[source, cli]
----
volume move start -perform-validation-only
----
+
Pour en savoir plus, `volume move start` consultez le link:https://docs.netapp.com/us-en/ontap-cli/volume-move-start.html["Référence de commande ONTAP"^].

. Augmenter le volume :
+
[source, cli]
----
volume move start
----
+
La commande suivante déplace le volume user_max du SVM vs2 vers l'agrégat node 12a_aggr3. Le déplacement s'exécute en arrière-plan.

+
[listing]
----
cluster1::> volume move start -vserver vs2 -volume user_max
-destination-aggregate node12a_aggr3
----
. Déterminer l’état de l’opération de déplacement du volume :
+
[source, cli]
----
volume move show
----
+
L'exemple suivant montre l'état du déplacement d'un volume qui a terminé la phase de réplication et qui est en phase de mise en service :

+
[listing]
----

cluster1::> volume move show
Vserver   Volume     State    Move Phase  Percent-Complete Time-To-Complete
--------- ---------- -------- ----------  ---------------- ----------------
vs2       user_max   healthy  cutover     -                -
----
+
Le déplacement de volume est terminé lorsqu'il n'apparaît plus dans le `volume move show` sortie de la commande.

+
Pour en savoir plus, `volume move show` consultez le link:https://docs.netapp.com/us-en/ontap-cli/volume-move-show.html["Référence de commande ONTAP"^].

. En option, affichez les économies de compression :
+
[source, cli]
----
volume show-footprint -vserver <SVM> -volume <volume_name>
----
+

NOTE: Des économies supplémentaires au niveau global pourraient être réalisées grâce à une analyse de conversion post-traitement qui s'exécute automatiquement et peu de temps après la fin du déplacement du volume.



.Informations associées
* link:recommendations-moving-concept.html["Considérations et recommandations lors du déplacement de volumes"]

